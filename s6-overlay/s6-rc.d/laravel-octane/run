#!/bin/sh
# Ensure octane directory exists and has correct permissions
mkdir -p /tmp/octane
chmod 777 /tmp/octane

cd /var/www/html

# Export Octane state file environment variable
export OCTANE_STATE_FILE=/tmp/octane/state.json

# Start Octane
exec php artisan octane:start \
    --server=frankenphp \
    --host="${OCTANE_HOST:-0.0.0.0}" \
    --port="${OCTANE_PORT:-8001}" \
    --admin-port="${OCTANE_ADMIN_PORT:-2019}" \
    --workers=auto \
    --max-requests=1000 \
    --watch